general:
  branches:
    ignore:
      # We only want to build pull requests for testing. If something is merged,
      # then we are prepping for release an there is no need to build it again.
      - master
  artifacts:
      - tests_html
      - tests_png

checkout:
  post:
    - ./scripts/checkout_merge_commit.sh

#machine:
machine:
    pre:
        - sudo -H pip install --upgrade virtualenv
        - ls
        - pwd
        - bash vcs/scripts/circleci_mac_machine_pre.sh
      #  services:
#    - docker

dependencies:
    override:
    #- docker pull cdat/conda:conda-forge-cdms2
        - bash ./scripts/circleci_mac_dep.sh
  

test:
  override:
      #      - docker run -it -v `pwd`:/git_repo -a STDOUT -a STDERR -P cdat/conda:conda-forge-cdms2 /git_repo/scripts/circle.sh
      - bash ./scripts/circleci_mac.sh
